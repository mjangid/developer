/*!
  Copyright (C) Microsoft. All rights reserved.
*/
(function(){"use strict";typeof MicrosoftNSJS=="undefined"&&Object.defineProperty(window,"MicrosoftNSJS",{value:{},writable:!1,enumerable:!0,configurable:!0});typeof MicrosoftNSJS.Advertising=="undefined"&&Object.defineProperty(MicrosoftNSJS,"Advertising",{value:{},writable:!1,enumerable:!0,configurable:!0});MicrosoftNSJS.Advertising.MediaProgress={start:"start",firstQuartile:"firstQuartile",midpoint:"midpoint",thirdQuartile:"thirdQuartile",complete:"complete"};MicrosoftNSJS.Advertising.Timeslot=function(n){this.startTime=n;this._breaks=[];this._remainingDuration=null};MicrosoftNSJS.Advertising.Timeslot.prototype={get startTime(){return this._startTime},set startTime(n){this._startTime=typeof n=="number"?n:null},get remainingDuration(){return typeof this._remainingDuration!="number"&&this.updateRemainingDuration(),this._remainingDuration},addBreak:function(n){for(var t=0;t<this._breaks.length;t++)if(this._breaks[t]===n)return;this._breaks.push(n);this._remainingDuration=null},removeBreak:function(n){for(var t=0;t<this._breaks.length;t++)if(this._breaks[t]===n){this._breaks.splice(t,1);this._remainingDuration=null;return}},getNextBreak:function(){for(;this._breaks.length!==0;){if(this._breaks[0].getNextClip())return this._breaks[0];this._breaks.splice(0,1)}return null},getBreakByPodId:function(n){for(var t=0;t<this._breaks.length;t++)if(this._breaks[t].podId===n)return this._breaks[t];return null},updateRemainingDuration:function(){for(var i=0,t,n=0;n<this._breaks.length;n++)t=this._breaks[n],t.updateRemainingDuration(),i+=t.remainingDuration;return this._remainingDuration=i,this._remainingDuration}};MicrosoftNSJS.Advertising.ClipScheduler=function(t,i){var r=t?t.tvControl||t.winControl:null,u;if(r&&r.mediaElementAdapter)this._mediaPlayer=r;else{u=new Error(n.mediaPlayerRequired);u.name="MicrosoftNSJS.Advertising.ClipScheduler.mediaPlayerRequired";throw u;}this._allClips=[];this._timeslots={};this._lastContentTime=0;this._playSkippedMedia=!0;this._skipThresholdSeconds=2;this._endOfClipTimeDelta=.25;this._endOfClipTimeDeltaWhenFF=1.5;this._isDisposed=!1;this._mediaTimeout=0;this._mediaTimeoutTimerId=null;this._priorIsPauseAllowed=!0;this._priorIsSeekAllowed=!0;this._priorIsThumbnailEnabled=!0;this._priorDisplayValue=null;this._mediaElement=null;this._currentBreak=null;this._currentTimeslot=null;this._currentClip=null;this._isInMediaBreak=!1;this._firedEvents={};this._transportControlsEnabled=!0;this._lastClipTime=0;this._maxClipTime=0;this._userSkippedAhead=!1;this._previousMarkers=null;this._cachedVideoElement=null;this._onMediaProgress=null;this._onMediaBreakStart=null;this._onMediaBreakEnd=null;this._onAllComplete=null;this._onMediaError=null;this._onBreakCountdown=null;this._clipEventSubscriptions=[];this._addContentEventListeners(this._mediaPlayer.mediaElementAdapter.mediaElement);t.addEventListener("mediaelementchanged",this._mediaElementChangedHandler.bind(this));this._setOptions(this,i)};MicrosoftNSJS.Advertising.ClipScheduler.prototype={get playSkippedMedia(){return this._playSkippedMedia},set playSkippedMedia(n){this._playSkippedMedia=n},get onMediaProgress(){return this._onMediaProgress},set onMediaProgress(n){(typeof n=="function"||n===null||typeof n=="undefined")&&(this._onMediaProgress=n)},get onMediaBreakStart(){return this._onMediaBreakStart},set onMediaBreakStart(n){(typeof n=="function"||n===null||typeof n=="undefined")&&(this._onMediaBreakStart=n)},get onMediaBreakEnd(){return this._onMediaBreakEnd},set onMediaBreakEnd(n){(typeof n=="function"||n===null||typeof n=="undefined")&&(this._onMediaBreakEnd=n)},get onMediaError(){return this._onMediaError},set onMediaError(n){(typeof n=="function"||n===null||typeof n=="undefined")&&(this._onMediaError=n)},get onAllComplete(){return this._onAllComplete},set onAllComplete(n){(typeof n=="function"||n===null||typeof n=="undefined")&&(this._onAllComplete=n)},get onBreakCountdown(){return this._onBreakCountdown},set onBreakCountdown(n){(typeof n=="function"||n===null||typeof n=="undefined")&&(this._onBreakCountdown=n)},get mediaTimeout(){return this._mediaTimeout},set mediaTimeout(n){this._mediaTimeout!==n&&(this._mediaTimeout=n)},scheduleMedia:function(t){var r,i;if(!this._isDisposed&&!this._mediaPlayer._disposed){if(typeof t!="object"||t===null){r=new Error(n.scheduleDataNotAnObject);r.name="MicrosoftNSJS.Advertising.ClipScheduler.scheduleDataNotAnObject";throw r;}(typeof this._allClips!="object"||this._allClips===null)&&(this._allClips=[]);MicrosoftNSJS.Advertising.Clip.prototype.isPrototypeOf(t)||(t=new MicrosoftNSJS.Advertising.Clip(t));t.validate();this._allClips.push(t);i=this._getMainMediaElement();t.calculateStartTime(i?i.duration:NaN);this._addClipToBreak(t);this._currentClip||i&&i.src!==""&&i.paused||this._mainMediaTimeUpdate()}},dispose:function(){this._mediaPlayer&&(this._clearMediaTimeout(),this._mediaElement&&this._removeCurrentClip(),this._isInMediaBreak&&this._resumeMainMedia(),this._removeAdMarkersFromTimeline(),this._mediaPlayer&&this._mediaPlayer.mediaElementAdapter&&this._removeContentEventListeners(this._mediaPlayer.mediaElementAdapter.mediaElement),this._allClips=null,this._timeslots=null,this._priorDisplayValue=null,this._mediaElement=null,this._currentBreak=null,this._currentTimeslot=null,this._currentClip=null,this._firedEvents=null,this._mediaPlayer=null,this._previousMarkers=null,this._onMediaProgress=null,this._onMediaBreakStart=null,this._onMediaBreakEnd=null,this._onAllComplete=null,this._cachedVideoElement=null,this._isDisposed=!0)},_getMainMediaElement:function(){return this._currentClip?document.querySelector(".uac-main-content"):this._mediaPlayer.mediaElementAdapter.mediaElement},_addClipToBreak:function(n){if(n===null||typeof n.startTime!="number")return null;var i=this._getOrCreateTimeslot(n.startTime),t=i.getBreakByPodId(n.podId);return t?t.addClip(n):(t=this._createBreak(n),i.addBreak(t)),t},_getOrCreateTimeslot:function(n){var t=null;return n in this._timeslots?t=this._timeslots[n]:(this._addMarkerToTimeline(n),t=new MicrosoftNSJS.Advertising.Timeslot(n),this._timeslots[n]=t),t},_createBreak:function(n){var t=new MicrosoftNSJS.Advertising.Break({startTime:n.startTime,podId:n.podId});return t.addClip(n),t},_addMarkersToTimeline:function(){var n,t;if(this._previousMarkers!==null){for(n=0;n<this._previousMarkers.length;n++)this._mediaPlayer.addMarker(this._previousMarkers[n].time,this._previousMarkers[n].type,this._previousMarkers[n].data,this._previousMarkers[n].extraClass);this._previousMarkers=null}if(this._timeslots)for(t in this._timeslots)this._addMarkerToTimeline(parseFloat(t))},_addMarkerToTimeline:function(n){if(typeof n=="number"&&this._mediaPlayer&&!this._mediaPlayer._disposed&&!this._currentClip){var t=this._getMarkerAtTime(n);t===null&&(typeof TVJS!="undefined"?this._mediaPlayer.addMarker(n,TVJS.MarkerType.advertisement,{},""):this._mediaPlayer.addMarker(n,XboxJS.UI.MarkerType.advertisement,{},""))}},_removeMarkersFromTimeline:function(){this._removeAdMarkersFromTimeline();this._mediaPlayer&&this._mediaPlayer.markers&&this._mediaPlayer.markers.length>0&&(this._previousMarkers=this._mediaPlayer.markers.slice(),this._mediaPlayer.markers.length=0)},_removeAdMarkersFromTimeline:function(){if(this._timeslots)for(var n in this._timeslots)this._removeMarkerFromTimeline(parseFloat(n))},_removeMarkerFromTimeline:function(n){if(typeof n=="number"&&this._mediaPlayer&&!this._mediaPlayer._disposed&&!this._currentClip){var i=typeof TVJS!="undefined"?TVJS.MarkerType.advertisement:XboxJS.UI.MarkerType.advertisement,t=this._getMarkerAtTime(n);t&&(t.markerType||t.type)==i&&this._mediaPlayer.removeMarker(n)}},_getMarkerAtTime:function(n){var i,t;if(this._mediaPlayer&&this._mediaPlayer.markers)for(i=this._mediaPlayer.markers,t=0;t<i.length;t++)if(i[t].time===n)return i[t];return null},_addContentEventListeners:function(n){n&&(this._eventHandlerMainTimeUpdate=this._mainMediaTimeUpdate.bind(this),n.addEventListener("timeupdate",this._eventHandlerMainTimeUpdate),this._eventHandlerDurationChange=this._contentDurationChangeHandler.bind(this),n.addEventListener("durationchange",this._eventHandlerDurationChange),this._eventHandlerSrcChange=this._contentSrcChangeHandler.bind(this),n.addEventListener("DOMAttrModified",this._eventHandlerSrcChange),this._eventHandlerVolumeChange=this._contentVolumeChangeHandler.bind(this),n.addEventListener("volumechange",this._eventHandlerVolumeChange))},_removeContentEventListeners:function(n){n&&(this._eventHandlerDurationChange&&n.removeEventListener("durationchange",this._eventHandlerDurationChange),this._eventHandlerMainTimeUpdate&&n.removeEventListener("timeupdate",this._eventHandlerMainTimeUpdate),this._eventHandlerSrcChange&&n.removeEventListener("DOMAttrModified",this._eventHandlerSrcChange),this._eventHandlerVolumeChange&&n.removeEventListener("volumechange",this._eventHandlerVolumeChange));this._eventHandlerDurationChange=null;this._eventHandlerMainTimeUpdate=null;this._eventHandlerSrcChange=null;this._eventHandlerVolumeChange=null},_mediaElementChangedHandler:function(){if(!this._ignoreMediaElementChange&&!this._isDisposed)if(this._currentClip)this._fireMediaErrorEvent(this,{message:n.contentChangedDuringClipPlayback,errorCode:MicrosoftNSJS.Advertising.AdErrorCode.other,clip:this._currentClip});else if(this._mediaPlayer.mediaElementAdapter.mediaElement){var t=this._mediaPlayer.mediaElementAdapter.mediaElement.duration;this._recalculateStartTimes(t);this._addContentEventListeners(this._mediaPlayer.mediaElementAdapter.mediaElement)}},_recalculateStartTimes:function(n){var i,t;for(this._removeAdMarkersFromTimeline(),this._timeslots={},i=0;i<this._allClips.length;i++)t=this._allClips[i],t.isPlayed||t.isSkipped||(t.calculateStartTime(n),this._addClipToBreak(t))},_contentSrcChangeHandler:function(n){n.attrName!=="src"||this._currentClip||setImmediate(this._addMarkersToTimeline.bind(this))},_contentVolumeChangeHandler:function(n){this._mediaElement&&n.srcElement&&(this._mediaElement.muted=n.srcElement.muted,this._mediaElement.volume=n.srcElement.volume)},_contentDurationChangeHandler:function(n){this._eventHandlerDurationChange&&(n.srcElement.removeEventListener("durationchange",this._eventHandlerDurationChange),this._eventHandlerDurationChange=null);this._isDisposed||this._recalculateStartTimes(n.srcElement.duration)},_mainMediaTimeUpdate:function(n){var t,i,r;this._isDisposed||this._currentClip||this._mediaPlayer._disposed||(t=n&&n.srcElement?n.srcElement.currentTime:0,this._mainMediaEnded=n&&n.srcElement&&t>=n.srcElement.duration,i=this._getTimeslotForCurrentTime(t),i&&(r=this._prepareNextClip(i),r!==null&&(this._pauseMainMedia(),this._playClip(r))),this._mainMediaEnded&&!this._currentClip&&this._fireAllCompleteEvent())},_getTimeslotForCurrentTime:function(n){var t,r,i;if(this._isDisposed)return null;if(t=null,this._playSkippedMedia||n-this._lastContentTime<=1)for(r in this._timeslots)i=parseFloat(r),(this._lastContentTime<i&&i<=n||this._lastContentTime===0&&i===0)&&(!t||t.startTime<i)&&(t=this._timeslots[i]);return t&&t.updateRemainingDuration(),this._lastContentTime=n,t},_prepareNextClip:function(n){var i=null,t;return n&&(t=n.getNextBreak(),t?i=t.getNextClip():this._removeTimeslot(n)),i!==null?(this._currentBreak=t,this._currentTimeslot=n):(this._currentBreak=null,this._currentTimeslot=null),i},_playClip:function(n){if(typeof n=="object"&&n!==null&&!this._isDisposed&&!this._mediaPlayer._disposed&&(typeof this._currentClip!="object"||this._currentClip===null)&&(this._firedEvents={},this._isInMediaBreak||(this._isInMediaBreak=!0,this._fireMediaBreakStartEvent(this._currentBreak),!this._isDisposed&&!this._mediaPlayer._disposed))){var t=this._mediaPlayer.mediaElementAdapter.mediaElement;t&&this._addClassToElement(t,"uac-main-content");this._removeMarkersFromTimeline();this._currentClip=n;this._lastClipTime=0;this._maxClipTime=0;this._userSkippedAhead=!1;this._mediaElement=this._createMediaElement(n.type,n.url);this._mediaElement.canHaveHTML=!0;this._addClipEventListener(this._mediaElement,"timeupdate",this._clipTimeUpdate.bind(this));this._addClipEventListener(this._mediaElement,"ended",this._clipEndedHandler.bind(this));this._addClipEventListener(this._mediaElement,"error",this._clipErrorOccurred.bind(this));this._addClipEventListener(this._mediaElement,"durationchange",this._clipDurationChangeHandler.bind(this));this._ignoreMediaElementChange=!0;this._mediaPlayer.mediaElementAdapter.mediaElement=this._mediaElement;this._ignoreMediaElementChange=!1;this._mediaPlayer.hideControls();this._mediaPlayer.mediaElementAdapter.isSeekAllowed=n.skipOffsetParsed===0;t&&(this._priorDisplayValue=t.style.display,t.style.display="none",this._mediaElement.muted=t.muted,this._mediaElement.volume=t.volume);this.win8Overlay&&(this.win8Overlay.style.display="block");this._startMediaTimeout()}},_clipEndedHandler:function(){this._clipEnded(!1)},_clipEnded:function(n){var i,t;this._clearMediaTimeout();this._currentClip&&(i=this._currentClip,this._removeCurrentClip(),this._currentTimeslot&&this._currentTimeslot.updateRemainingDuration(),this._userSkippedAhead||n||this._fireProgressEvent(i,MicrosoftNSJS.Advertising.MediaProgress.complete),t=this._currentBreak?this._currentBreak.getNextClip():null,t!==null||this._isDisposed||(this._fireMediaBreakEndEvent(this._currentBreak),this._currentTimeslot&&this._currentTimeslot.removeBreak(this._currentBreak),this._currentBreak=null,this._isInMediaBreak=!1,this._currentTimeslot&&(t=this._prepareNextClip(this._currentTimeslot))),t!==null?this._playClip(t):(this._resumeMainMedia(),this._checkForAllComplete()))},_removeTimeslot:function(n){this._removeMarkerFromTimeline(n.startTime);delete this._timeslots[n.startTime]},_checkForAllComplete:function(){if(!this._currentClip&&!this._isDisposed){var n=this._mediaPlayer&&this._mediaPlayer.mediaElementAdapter?this._mediaPlayer.mediaElementAdapter.mediaElement:null;(!n||n.src===""||this._mainMediaEnded)&&this._fireAllCompleteEvent()}},_startMediaTimeout:function(){if(this._mediaTimeout!==0&&!this._isDisposed&&!this._mediaPlayer._disposed){this._clearMediaTimeout();var t=this._mediaPlayer.mediaElementAdapter.mediaElement;this._mediaTimeoutTimerId=setTimeout(function(){this._mediaTimeoutTimerId=null;this._mediaPlayer&&this._mediaPlayer.mediaElementAdapter&&this._mediaPlayer.mediaElementAdapter.mediaElement&&t===this._mediaPlayer.mediaElementAdapter.mediaElement&&this._mediaPlayer.mediaElementAdapter.mediaElement.currentTime===0&&this._clipErrorOccurred({errorMessage:n.mediaTimeout,errorCode:MicrosoftNSJS.Advertising.AdErrorCode.networkConnectionFailure});t=null}.bind(this),this._mediaTimeout)}},_clearMediaTimeout:function(){this._mediaTimeoutTimerId&&typeof this._mediaTimeoutTimerId=="number"&&(clearTimeout(this._mediaTimeoutTimerId),this._mediaTimeoutTimerId=null)},_clipErrorOccurred:function(n){var t=null,i,r;if(n.target&&n.target.error){i=n.target.error;switch(i.code){case MediaError.MEDIA_ERR_ABORTED:t="media playback aborted";break;case MediaError.MEDIA_ERR_DECODE:t="media decode failure";break;case MediaError.MEDIA_ERR_NETWORK:t="media download failure";break;case MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:t="media src not supported";break;default:t="media error code: "+i.code}}else t=n.errorMessage?n.errorMessage:"An error occurred during media playback.";r=n.errorCode?n.errorCode:MicrosoftNSJS.Advertising.AdErrorCode.other;this._fireMediaErrorEvent(this,{message:t,errorCode:r,clip:this._currentClip});this._clipEnded(!0)},_removeCurrentClip:function(){if(this._mediaElement){this._removeAllClipEventListeners(this._mediaElement);this._mediaElement.parentNode&&this._mediaElement.parentNode.removeChild(this._mediaElement);this._cacheMediaElement(this._mediaElement);this._mediaElement=null;this._currentClip.isPlayed=!0;this._currentClip=null;var n=document.querySelector(".uac-main-content");n&&(this._removeClassFromElement(n,"uac-main-content"),n.style.display=this._priorDisplayValue,this._priorDisplayValue=null);this._mediaPlayer.mediaElementAdapter&&(this._ignoreMediaElementChange=!0,this._mediaPlayer.mediaElementAdapter.mediaElement=n,this._ignoreMediaElementChange=!1)}},_getClosedCaptionsButton:function(){var n=this._mediaPlayer.element.querySelector(".tv-mediaplayer-closedcaptionsbutton");return n||(n=this._mediaPlayer.element.querySelector(".win-mediaplayer-closedcaptionsbutton")),n},_pauseMainMedia:function(){var n,t;this._mediaPlayer&&this._mediaPlayer.mediaElementAdapter&&(n=this._mediaPlayer.mediaElementAdapter,this._priorIsPauseAllowed=n.isPauseAllowed,this._priorIsSeekAllowed=n.isSeekAllowed,this._priorIsThumbnailEnabled=this._mediaPlayer.isThumbnailEnabled,n.isPauseAllowed=!0,n.isSeekAllowed=!1,this._mediaPlayer.isThumbnailEnabled=!1,this._mediaPlayer.element&&(t=this._getClosedCaptionsButton(),t&&(this._priorCaptionsButtonDisabled=t.disabled,t.disabled=!0)),this._mediaPlayer.pause())},_resumeMainMedia:function(){var t,n;!this._isDisposed&&this._mediaPlayer&&this._mediaPlayer.mediaElementAdapter&&(this._addMarkersToTimeline(),this.win8Overlay&&(this.win8Overlay.style.display="none"),this._mediaPlayer.element&&typeof this._priorCaptionsButtonDisabled=="boolean"&&(t=this._getClosedCaptionsButton(),t&&(t.disabled=this._priorCaptionsButtonDisabled,this._priorCaptionsButtonDisabled=null)),this._mediaPlayer.isThumbnailEnabled=this._priorIsThumbnailEnabled,n=this._mediaPlayer.mediaElementAdapter,n&&(n.isPlayAllowed=!0,this._mainMediaEnded||this._mediaPlayer.play(),typeof this._priorIsSeekAllowed=="boolean"&&(n.isPauseAllowed=this._priorIsPauseAllowed,n.isSeekAllowed=this._priorIsSeekAllowed)))},_clipDurationChangeHandler:function(){!this._currentClip||this._isDisposed||this._mediaPlayer._disposed||(this._currentClip.duration=this._mediaPlayer.mediaElementAdapter.mediaElement.duration,this._currentTimeslot.updateRemainingDuration())},_clipTimeUpdate:function(){if(this._currentClip&&!this._isDisposed&&this._mediaPlayer.mediaElementAdapter){var n=this._mediaPlayer.mediaElementAdapter.mediaElement.currentTime;if(this._fireCountdownEvent(),this._isDisposed)return;!this._userSkippedAhead&&n-this._maxClipTime>this._skipThresholdSeconds&&(this._userSkippedAhead=!0);this._mediaPlayer.mediaElementAdapter&&!this._mediaPlayer.mediaElementAdapter.isSeekAllowed&&typeof this._currentClip.skipOffsetParsed=="number"&&n>this._currentClip.skipOffsetParsed&&(this._mediaPlayer.mediaElementAdapter.isSeekAllowed=!0);this._currentClip.duration&&this._currentClip.duration!==0||this._mediaElement&&this._mediaElement.duration>0&&(this._currentClip.duration=this._mediaElement.duration);this._currentClip.duration&&this._currentClip.duration!==0&&(this._userSkippedAhead||this._checkProgressEvents(n,this._currentClip.duration),this._currentClip&&(n+this._endOfClipTimeDelta>=this._currentClip.duration||n+this._endOfClipTimeDeltaWhenFF>=this._currentClip.duration&&n-this._lastClipTime>this._skipThresholdSeconds)&&this._clipEnded(!1));n>this._maxClipTime&&(this._maxClipTime=n);this._lastClipTime=n}},_checkProgressEvents:function(n,t){this._fireEventIfTimeReached(n,0,MicrosoftNSJS.Advertising.MediaProgress.start);this._fireEventIfTimeReached(n,.25*t,MicrosoftNSJS.Advertising.MediaProgress.firstQuartile);this._fireEventIfTimeReached(n,.5*t,MicrosoftNSJS.Advertising.MediaProgress.midpoint);this._fireEventIfTimeReached(n,.75*t,MicrosoftNSJS.Advertising.MediaProgress.thirdQuartile)},_fireEventIfTimeReached:function(n,t,i){this._lastClipTime<=t&&t<=n&&this._fireProgressEvent(this._currentClip,i)},_createMediaElement:function(n,t){var i=null;return n.toLowerCase()==="video"&&this._cachedVideoElement?(i=this._cachedVideoElement,this._cachedVideoElement=null):i=document.createElement(n),i.id="_msAdElement",i.src=t,i.autoplay=!0,i.controls=!1,i},_cacheMediaElement:function(n){n&&n.nodeName==="VIDEO"&&(this._cachedVideoElement=n,this._cachedVideoElement.removeAttribute("src"))},_fireProgressEvent:function(n,t){if(!this._isDisposed){if(this._firedEvents[t])return;this._firedEvents[t]=!0;typeof this._onMediaProgress=="function"&&this._onMediaProgress(this,{clip:n,progress:t})}},_fireCountdownEvent:function(){if(typeof this._onBreakCountdown=="function"){var n=this._mediaElement.currentTime,t={remainingAdTime:Math.round(100*(this._currentClip.duration-n))/100,remainingBreakTime:Math.round(100*(this._currentTimeslot.remainingDuration-n))/100};this._onBreakCountdown(this,t)}},_fireMediaBreakStartEvent:function(n){typeof this._onMediaBreakStart=="function"&&this._onMediaBreakStart(this,n)},_fireMediaBreakEndEvent:function(n){typeof this._onMediaBreakEnd=="function"&&this._onMediaBreakEnd(this,n)},_fireMediaErrorEvent:function(n,t){typeof this._onMediaError=="function"&&this._onMediaError(this,t)},_fireAllCompleteEvent:function(){this._firedEvents.allComplete||(this._firedEvents.allComplete=!0,typeof this._onAllComplete=="function"&&this._onAllComplete(this))},_addClipEventListener:function(n,t,i){n&&(n.addEventListener(t,i,!1),this._clipEventSubscriptions.push({eventName:t,handler:i}))},_removeClipEventListener:function(n,t){if(n)for(var i=0;i<this._clipEventSubscriptions.length;i++)if(t===this._clipEventSubscriptions[i].eventName){n.removeEventListener(t,this._clipEventSubscriptions[i].handler);this._clipEventSubscriptions.splice(i,1);break}},_removeAllClipEventListeners:function(n){var i,t;if(n)for(i=this._clipEventSubscriptions.length,t=0;t<i;t++)n.removeEventListener(this._clipEventSubscriptions[t].eventName,this._clipEventSubscriptions[t].handler);this._clipEventSubscriptions=[]},_setOptions:function(n,t){var f,r,s,i,u,e,o;if(typeof t=="object")for(f=Object.keys(t),r=0,s=f.length;r<s;r++){if(i=f[r],u=t[i],i.length>2&&(e=i[0],o=i[1],(e==="o"||e==="O")&&(o==="n"||o==="N")&&typeof u=="function"&&n.addEventListener)){n.addEventListener(i.substr(2),u);continue}n[i]=u}},_addClassToElement:function(n,t){var i=n.className||"",r=i.split(" ");r.indexOf(t)===-1&&(n.className=(i+" "+t).trim())},_removeClassFromElement:function(n,t){var f=n.className||"",i=f.split(" "),r=-1,u;(r=i.indexOf(t))!==-1&&(i.splice(r,1),u=i.join(" "),n.className=u)}};var n={get mediaPlayerRequired(){return"mediaPlayer is required input to the ClipScheduler"},get scheduleDataNotAnObject(){return"clip is not an object"},get mediaTimeout(){return"Request for media timed out."},get contentChangedDuringClipPlayback(){return"media element changed while clip was playing"}}})(),function(){"use strict";typeof MicrosoftNSJS=="undefined"&&Object.defineProperty(window,"MicrosoftNSJS",{value:{},writable:!1,enumerable:!0,configurable:!0});typeof MicrosoftNSJS.Advertising=="undefined"&&Object.defineProperty(MicrosoftNSJS,"Advertising",{value:{},writable:!1,enumerable:!0,configurable:!0});MicrosoftNSJS.Advertising.AdScheduler=function(t,i){var r,u;if(t){if(r=t.tvControl||t.winControl,r)this._mediaPlayer=r;else{u=new Error(n.mediaPlayerMustHaveTvControl);u.name="MicrosoftNSJS.Advertising.AdScheduler.mediaPlayerMustHaveTvControl";throw u;}this._element=this._createAnchorElement(t)}try{this._context=new Microsoft.Advertising.Shared.WinRT.ProjectedContext}catch(u){this._context=null}this._schedule=null;this._clipScheduler=null;this._requestInProgress=!1;this._isDisposed=!1;this._playSkippedMedia=!0;this._eventManager=new MicrosoftNSJS.Advertising.EventManager;this._onAdProgress=null;this._onErrorOccurred=null;this._onPodStart=null;this._onPodEnd=null;this._onPodCountdown=null;this._onAllComplete=null;this._eventHandlerAdTimeUpdateInfo=null;this._afterHideControlsHandler=null;this._requestTimeout=MicrosoftNSJS.Advertising.AdScheduler._defaultRequestTimeoutMs;this._mediaTimeout=MicrosoftNSJS.Advertising.AdScheduler._defaultMediaTimeoutMs;this._setOptions(this,i)};MicrosoftNSJS.Advertising.AdScheduler.prototype={get schedule(){return this._schedule},requestSchedule:function(t,i,r){var u,f;return typeof t=="undefined"||t===null||t===""||typeof i=="undefined"||i===null||i===""?(u=this._createErrorArgs(n.applicationIdAndAdUnitIdRequired,MicrosoftNSJS.Advertising.AdErrorCode.clientConfiguration),new Promise(function(n,t){t(u)})):(f=this._createAdTagCollectionFromJsonObject(r),this._sendRequest({applicationId:t,adUnitId:i,adTags:f}))},requestScheduleByUrl:function(t){var i=null;return(typeof t=="string"&&t!==""?this._isUrlValid(t)||(i=this._createErrorArgs(n.adServiceUrlNotValid,MicrosoftNSJS.Advertising.AdErrorCode.clientConfiguration)):i=this._createErrorArgs(n.adServiceUrlIsRequired,MicrosoftNSJS.Advertising.AdErrorCode.clientConfiguration),i!==null)?new Promise(function(n,t){t(i)}):this._sendRequest({serviceUrl:t})},addEventListener:function(n,t){this._eventManager&&this._eventManager.addEventListener(n,t)},removeEventListener:function(n,t){this._eventManager&&this._eventManager.removeEventListener(n,t)},dispose:function(){this._clipScheduler!==null&&(this._clipScheduler.dispose(),this._clipScheduler=null);this._schedule=null;this._onAdProgress=null;this._onErrorOccurred=null;this._onPodStart=null;this._onPodEnd=null;this._onPodCountdown=null;this._onAllComplete=null;this._mediaPlayer=null;this._eventManager&&(this._eventManager.dispose(),this._eventManager=null);this._element&&(this._element.parentElement&&this._element.parentElement.removeChild(this._element),this._element=null);this._isDisposed=!0},get onErrorOccurred(){return this._onErrorOccurred},set onErrorOccurred(n){(typeof n=="function"||n===null||typeof n=="undefined")&&(this._onErrorOccurred=n)},get onAdProgress(){return this._onAdProgress},set onAdProgress(n){(typeof n=="function"||n===null||typeof n=="undefined")&&(this._onAdProgress=n)},get onPodStart(){return this._onPodStart},set onPodStart(n){(typeof n=="function"||n===null||typeof n=="undefined")&&(this._onPodStart=n)},get onPodEnd(){return this._onPodEnd},set onPodEnd(n){(typeof n=="function"||n===null||typeof n=="undefined")&&(this._onPodEnd=n)},get onPodCountdown(){return this._onPodCountdown},set onPodCountdown(n){(typeof n=="function"||n===null||typeof n=="undefined")&&(this._onPodCountdown=n)},get onAllComplete(){return this._onAllComplete},set onAllComplete(n){(typeof n=="function"||n===null||typeof n=="undefined")&&(this._onAllComplete=n)},get requestTimeout(){return this._requestTimeout},set requestTimeout(n){this._requestTimeout!==n&&typeof n=="number"&&n>=0&&(this._requestTimeout=n)},get mediaTimeout(){return this._mediaTimeout},set mediaTimeout(n){this._mediaTimeout!==n&&typeof n=="number"&&n>=0&&(this._mediaTimeout=n)},get playSkippedMedia(){return this._playSkippedMedia},set playSkippedMedia(n){this._playSkippedMedia=n;this._clipScheduler&&(this._clipScheduler.playSkippedMedia=this._playSkippedMedia)},_isUrlValid:function(n){return n.match(/^https?:\/\/.+$/)===null?!1:!0},_getAdSchedulerClass:function(){return Microsoft.Advertising.Shared.WinRT.AdScheduler},_getProjectedMediaConstraintsClass:function(){return Microsoft.Advertising.Shared.WinRT.ProjectedMediaConstraints},_sendRequest:function(t){return new Promise(function(i,r){var u,f;if(this._requestInProgress){r(this._createErrorArgs(n.requestAlreadyInProgress,MicrosoftNSJS.Advertising.AdErrorCode.refreshNotAllowed));return}u=function(n){this._requestInProgress=!1;this._fireAllCompleteIfNoContent();r(n)}.bind(this);try{this._requestInProgress=!0;f=null;f=t.adUnitId?this._getAdSchedulerClass().getScheduleStrictAsync(t.applicationId,t.adUnitId,this._requestTimeout,16,t.adTags,this._context,this._getProjectedMediaConstraintsClass().defaultMediaConstraints):this._getAdSchedulerClass().getScheduleStrictAsync(t.serviceUrl,this._requestTimeout,16,this._context,this._getProjectedMediaConstraintsClass().defaultMediaConstraints);f.then(function(n){this._requestInProgress=!1;n!==null?n.error!==null?u(n.error):n.value!==null?(this._schedule=n.value,this._scheduleAdsInPlayer(n.value),this._clipScheduler&&this._clipScheduler._checkForAllComplete(),i(n.value)):u(this._createErrorArgs("schedule request returned empty object",MicrosoftNSJS.Advertising.AdErrorCode.other)):u(this._createErrorArgs("schedule is null",MicrosoftNSJS.Advertising.AdErrorCode.other))}.bind(this),function(){u(this._createErrorArgs("error occurred in request promise",MicrosoftNSJS.Advertising.AdErrorCode.other))}.bind(this))}catch(e){u(this._createErrorArgs(e.message,MicrosoftNSJS.Advertising.AdErrorCode.other))}}.bind(this))},_createAnchorElement:function(n){var t=document.createElement("div");return t.style.width="0px",t.style.height="0px",t.style.display="none",t.className="tv-disposable win-disposable uac-adscheduler-anchor",t.winControl=this,n.appendChild(t),t},_createAdTagCollectionFromJsonObject:function(n){var i=null,t;if(n&&typeof n=="object"){i=new Microsoft.Advertising.Shared.WinRT.AdTagCollection;for(t in n)if(n.hasOwnProperty(t)&&typeof t=="string"&&typeof n[t]=="string")try{i.addAdTag(t,n[t])}catch(r){this._fireErrorOccurred("could not add ad tag with key: "+t,MicrosoftNSJS.Advertising.AdErrorCode.other)}else this._fireErrorOccurred("could not add ad tag as key or value were not strings",MicrosoftNSJS.Advertising.AdErrorCode.other)}return i},_scheduleAdsInPlayer:function(n){var e,t,i,r,u;if(this._mediaPlayer&&this._mediaPlayer.element){if(this._clipScheduler===null)try{this._clipScheduler=this._createScheduler();this._addSchedulerListeners()}catch(f){e=f.message?f.message:"unable to create ClipScheduler";this._fireErrorOccurred(e,MicrosoftNSJS.Advertising.AdErrorCode.other);return}for(t=0;t<n.pods.length;t++)for(i=n.pods[t],r=0;r<i.packages.length;r++)u=i.packages[r],u.video&&u.video.length>0&&this._scheduleAd(i,u)}},_createScheduler:function(){return new MicrosoftNSJS.Advertising.ClipScheduler(this._mediaPlayer.element,{playSkippedMedia:this._playSkippedMedia,mediaTimeout:this._mediaTimeout})},_addSchedulerListeners:function(){this._clipScheduler&&(this._clipScheduler.onMediaProgress=this._mediaProgressHandler.bind(this),this._clipScheduler.onMediaBreakEnd=this._mediaBreakEndHandler.bind(this),this._clipScheduler.onMediaBreakStart=this._mediaBreakStartHandler.bind(this),this._clipScheduler.onMediaError=this._mediaErrorHandler.bind(this),this._clipScheduler.onAllComplete=this._allCompleteHandler.bind(this),this._clipScheduler.onBreakCountdown=this._breakCountdownHandler.bind(this))},_selectMedia:function(n){for(var i=null,r,u,t=0;t<n.length;t++)r=n[t],u=MicrosoftNSJS.Advertising.AdScheduler._isPreferredStream(r,i),u&&(i=r);return i},_scheduleAd:function(n,t){var i=this._createClip(n,t);try{this._clipScheduler.scheduleMedia(i)}catch(r){this._fireErrorOccurred(r.message,MicrosoftNSJS.Advertising.AdErrorCode.other)}},_createClip:function(t,i){var r=function(){var t=this._selectMedia(i.video);return t&&t.uri&&t.uri!==""?t.uri:(this._reportError(i,MicrosoftNSJS.Advertising.AdScheduler.VastErrorCode.noSupportedMedia),this._fireErrorOccurred(n.noSupportedMedia,MicrosoftNSJS.Advertising.AdErrorCode.invalidServerResponse),null)};return new MicrosoftNSJS.Advertising.Clip({timeOffset:t.time,type:"video",selectMedia:r.bind(this),skipOffset:i.skipOffset,podId:t.id,duration:MicrosoftNSJS.Advertising.AdUtilities.hhmmssToSeconds(i.duration),_package:i,_pod:t})},_allCompleteHandler:function(){this._fireAllCompleteEvent()},_breakCountdownHandler:function(n,t){this._fireCountdownEvent(t.remainingBreakTime,t.remainingAdTime)},_mediaBreakStartHandler:function(n,t){t&&t._clips&&t._clips[0]&&t._clips[0]._pod&&this._firePodStartEvent(t,t._clips[0]._pod)},_mediaBreakEndHandler:function(n,t){t&&t._clips&&t._clips[0]&&t._clips[0]._pod&&this._firePodEndEvent(t,t._clips[0]._pod)},_mediaErrorHandler:function(n,t){t&&t.clip&&this._reportError(t.clip._package,MicrosoftNSJS.Advertising.AdScheduler.VastErrorCode.unableToPlayFile);this._fireErrorOccurred(t.message,t.errorCode)},_mediaProgressHandler:function(n,t){this._fireProgressEvent(t.clip,t.progress)},_createErrorArgs:function(n,t){return{errorMessage:n,errorCode:t}},_fireCountdownEvent:function(n,t){var i={remainingPodTime:n,remainingAdTime:t};typeof this._onPodCountdown=="function"&&this._onPodCountdown(this,i);this._eventManager&&this._eventManager.broadcastEvent(MicrosoftNSJS.Advertising.AdScheduler.EventType.podCountdown,this,i)},_fireErrorOccurred:function(n,t){var i=this._createErrorArgs(n,t);typeof this._onErrorOccurred=="function"&&this._onErrorOccurred(this,i);this._eventManager&&this._eventManager.broadcastEvent(MicrosoftNSJS.Advertising.AdScheduler.EventType.errorOccurred,this,i)},_fireProgressEvent:function(n,t){var i=n._package,r;i&&i.reportAsync&&(t===MicrosoftNSJS.Advertising.MediaProgress.start&&(this._reportImpression(i),i.reportAsync("creativeView")),t===MicrosoftNSJS.Advertising.MediaProgress.complete?i.reportAsync(t):i.reportAsync(t));r={progress:t,adPackage:i,clip:n};typeof this._onAdProgress=="function"&&this._onAdProgress(this,r);this._eventManager&&this._eventManager.broadcastEvent(MicrosoftNSJS.Advertising.AdScheduler.EventType.adProgress,this,r)},_firePodStartEvent:function(n,t){t.reportAsync&&t.reportAsync(MicrosoftNSJS.Advertising.AdScheduler.AdBreakEvent.breakStart);var i={startTime:n.startTime,pod:t};typeof this._onPodStart=="function"&&this._onPodStart(this,i);this._eventManager&&this._eventManager.broadcastEvent(MicrosoftNSJS.Advertising.AdScheduler.EventType.podStart,this,i)},_firePodEndEvent:function(n,t){t.reportAsync&&t.reportAsync(MicrosoftNSJS.Advertising.AdScheduler.AdBreakEvent.breakEnd);var i={startTime:n.startTime,pod:t};typeof this._onPodEnd=="function"&&this._onPodEnd(this,i);this._eventManager&&this._eventManager.broadcastEvent(MicrosoftNSJS.Advertising.AdScheduler.EventType.podEnd,this,i)},_fireAllCompleteEvent:function(){typeof this._onAllComplete=="function"&&this._onAllComplete(this);this._eventManager&&this._eventManager.broadcastEvent(MicrosoftNSJS.Advertising.AdScheduler.EventType.allComplete,this)},_fireAllCompleteIfNoContent:function(){this._mediaPlayer&&this._mediaPlayer.mediaElementAdapter&&this._mediaPlayer.mediaElementAdapter.mediaElement&&this._mediaPlayer.mediaElementAdapter.mediaElement.src||this._fireAllCompleteEvent()},_reportError:function(n,t){if(n){var i=new Windows.Foundation.Collections.PropertySet;t&&(i.insert("[ERRORCODE]",t),i.insert("%5BERRORCODE%5D",t));n.reportAsync("error",i.getView())}},_reportImpression:function(n){n.reportAsync("impression")},_setOptions:function(n,t){var f,r,s,i,u,e,o;if(typeof t=="object")for(f=Object.keys(t),r=0,s=f.length;r<s;r++){if(i=f[r],u=t[i],i.length>2&&(e=i[0],o=i[1],(e==="o"||e==="O")&&(o==="n"||o==="N")&&typeof u=="function"&&n.addEventListener)){n.addEventListener(i.substr(2),u);continue}n[i]=u}}};MicrosoftNSJS.Advertising.AdScheduler.EventType={adProgress:"adProgress",errorOccurred:"errorOccurred",podStart:"podStart",podEnd:"podEnd",podCountdown:"podCountdown",allComplete:"allComplete"};MicrosoftNSJS.Advertising.AdScheduler._maxAdBitrate=2e3;MicrosoftNSJS.Advertising.AdScheduler._defaultRequestTimeoutMs=3e4;MicrosoftNSJS.Advertising.AdScheduler._defaultMediaTimeoutMs=3e4;MicrosoftNSJS.Advertising.AdScheduler._videoElement=null;MicrosoftNSJS.Advertising.AdScheduler.AdBreakEvent={breakStart:"breakStart",breakEnd:"breakEnd",error:"error"};MicrosoftNSJS.Advertising.AdScheduler.VastErrorCode={generalLinearError:"400",fileNotFound:"401",mediaTimeout:"402",noSupportedMedia:"403",unableToPlayFile:"405"};MicrosoftNSJS.Advertising.AdScheduler.canPlayType=function(n){return MicrosoftNSJS.Advertising.AdScheduler._videoElement||(MicrosoftNSJS.Advertising.AdScheduler._videoElement=document.createElement("video")),MicrosoftNSJS.Advertising.AdScheduler._videoElement.canPlayType(n)!==""};MicrosoftNSJS.Advertising.AdScheduler._endsWith=function(n,t){return n&&typeof n=="string"&&t&&typeof t=="string"&&n.length>=t.length&&n.toLowerCase().substr(n.length-t.length,t.length)===t?!0:!1};MicrosoftNSJS.Advertising.AdScheduler._getStreamPreferenceRank=function(n){if(!n)return 0;var t=typeof n.type=="string"?n.type.toLowerCase():"",i=typeof n.uri=="string"?n.uri.toLowerCase():"";return t==="application/dash+xml"?3:t==="application/vnd.apple.mpegurl"||t==="application/x-mpegurl"||MicrosoftNSJS.Advertising.AdScheduler._endsWith(i,".m3u8")||i.indexOf(".m3u8?")!==-1?2:MicrosoftNSJS.Advertising.AdScheduler.canPlayType(t)&&n.bitrate<=MicrosoftNSJS.Advertising.AdScheduler._maxAdBitrate?1:0};MicrosoftNSJS.Advertising.AdScheduler._isPreferredStream=function(n,t){var i=MicrosoftNSJS.Advertising.AdScheduler._getStreamPreferenceRank(n),r;return i===0?!1:(r=MicrosoftNSJS.Advertising.AdScheduler._getStreamPreferenceRank(t),r!==i?i>r:n.width>t.width)};var n={get mediaPlayerMustHaveTvControl(){return"mediaPlayer HTML element must have a MediaPlayer control"},get applicationIdAndAdUnitIdRequired(){return"applicationId and adUnitId are required"},get adServiceUrlIsRequired(){return"adServiceUrl is required"},get adServiceUrlNotValid(){return"adServiceUrl is not a valid url"},get requestAlreadyInProgress(){return"request is already in progress"},get noSupportedMedia(){return"an ad package did not contain any supported media"}}}();
// SIG // Begin signature block
// SIG // MIIdogYJKoZIhvcNAQcCoIIdkzCCHY8CAQExCzAJBgUr
// SIG // DgMCGgUAMGcGCisGAQQBgjcCAQSgWTBXMDIGCisGAQQB
// SIG // gjcCAR4wJAIBAQQQEODJBs441BGiowAQS9NQkAIBAAIB
// SIG // AAIBAAIBAAIBADAhMAkGBSsOAwIaBQAEFJofKkre6zqz
// SIG // Cu/CINp/Gtg4YSZPoIIYZDCCBMMwggOroAMCAQICEzMA
// SIG // AACampsWwoPa1cIAAAAAAJowDQYJKoZIhvcNAQEFBQAw
// SIG // dzELMAkGA1UEBhMCVVMxEzARBgNVBAgTCldhc2hpbmd0
// SIG // b24xEDAOBgNVBAcTB1JlZG1vbmQxHjAcBgNVBAoTFU1p
// SIG // Y3Jvc29mdCBDb3Jwb3JhdGlvbjEhMB8GA1UEAxMYTWlj
// SIG // cm9zb2Z0IFRpbWUtU3RhbXAgUENBMB4XDTE2MDMzMDE5
// SIG // MjEyOVoXDTE3MDYzMDE5MjEyOVowgbMxCzAJBgNVBAYT
// SIG // AlVTMRMwEQYDVQQIEwpXYXNoaW5ndG9uMRAwDgYDVQQH
// SIG // EwdSZWRtb25kMR4wHAYDVQQKExVNaWNyb3NvZnQgQ29y
// SIG // cG9yYXRpb24xDTALBgNVBAsTBE1PUFIxJzAlBgNVBAsT
// SIG // Hm5DaXBoZXIgRFNFIEVTTjpCMUI3LUY2N0YtRkVDMjEl
// SIG // MCMGA1UEAxMcTWljcm9zb2Z0IFRpbWUtU3RhbXAgU2Vy
// SIG // dmljZTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoC
// SIG // ggEBAKZGcyHKAK1+KMPlE5szicc4CJIlJq0R/J8UFYJz
// SIG // YmMl8u5Me1+ZqDys5iCAV+aHEnUP3noHraQ8R7DXhYSg
// SIG // Tpdd35govgBRMWpxghNHe/vJe/YXSUkkzhe2TXlHhE1j
// SIG // j+O0JQyknC4q9qi2dcccePDGAKm0jt9MuccG/XAq+I7Q
// SIG // IR6DgWUMnECilK4qJilajEqeW2FMnFSesDzqkidwXk7j
// SIG // J2Li4DZKnPXh/Vs33s9dAcsKdcz83tvYtINUy3uDKYZR
// SIG // ECNHwStxzK+Wzlx8yprFXADBj2rK1JKn2K/rvhWbtKgd
// SIG // xGuEfFh0sDZkj9KCLPgMuSwKVnof6AmHqQbfHNUCAwEA
// SIG // AaOCAQkwggEFMB0GA1UdDgQWBBQmmgbvkXTwOgin21sU
// SIG // 7d0HCiAvCTAfBgNVHSMEGDAWgBQjNPjZUkZwCu1A+3b7
// SIG // syuwwzWzDzBUBgNVHR8ETTBLMEmgR6BFhkNodHRwOi8v
// SIG // Y3JsLm1pY3Jvc29mdC5jb20vcGtpL2NybC9wcm9kdWN0
// SIG // cy9NaWNyb3NvZnRUaW1lU3RhbXBQQ0EuY3JsMFgGCCsG
// SIG // AQUFBwEBBEwwSjBIBggrBgEFBQcwAoY8aHR0cDovL3d3
// SIG // dy5taWNyb3NvZnQuY29tL3BraS9jZXJ0cy9NaWNyb3Nv
// SIG // ZnRUaW1lU3RhbXBQQ0EuY3J0MBMGA1UdJQQMMAoGCCsG
// SIG // AQUFBwMIMA0GCSqGSIb3DQEBBQUAA4IBAQCJehwGFIbD
// SIG // v+5TfA//GKMWAGxUw9KZZvNqxbNTH3/VgV9R8/z6Lqiv
// SIG // 0Y0RH9q3RKNwAhBNsIT2njVXk4PeJqyb4884skOIK8vl
// SIG // V0vWUmtcbTARAu+pUZbB4oK/Z6uaECCEFKny/OromIJS
// SIG // dXwD3txRJK1umXshuqEqLPVjxAE01+WgDEnUCt1uAQux
// SIG // L2lxU/GPEcPl2w0LfSyUhk1nF3nYKHrloO5UvDdy8ZqL
// SIG // 1Hc4YFOvg2ScMl6+Vy6dpeZ78el6NHeRHnRMqsdL59xq
// SIG // 4XlayVog0TOb5ffjo7l67nWYUo/ViOKrtyqsfoqBKRvR
// SIG // cKkPD7NmpVq1jr1cvPdVvPkQMIIGBzCCA++gAwIBAgIK
// SIG // YRZoNAAAAAAAHDANBgkqhkiG9w0BAQUFADBfMRMwEQYK
// SIG // CZImiZPyLGQBGRYDY29tMRkwFwYKCZImiZPyLGQBGRYJ
// SIG // bWljcm9zb2Z0MS0wKwYDVQQDEyRNaWNyb3NvZnQgUm9v
// SIG // dCBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkwHhcNMDcwNDAz
// SIG // MTI1MzA5WhcNMjEwNDAzMTMwMzA5WjB3MQswCQYDVQQG
// SIG // EwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UE
// SIG // BxMHUmVkbW9uZDEeMBwGA1UEChMVTWljcm9zb2Z0IENv
// SIG // cnBvcmF0aW9uMSEwHwYDVQQDExhNaWNyb3NvZnQgVGlt
// SIG // ZS1TdGFtcCBQQ0EwggEiMA0GCSqGSIb3DQEBAQUAA4IB
// SIG // DwAwggEKAoIBAQCfoWyx39tIkip8ay4Z4b3i48WZUSNQ
// SIG // rc7dGE4kD+7Rp9FMrXQwIBHrB9VUlRVJlBtCkq6YXDAm
// SIG // 2gBr6Hu97IkHD/cOBJjwicwfyzMkh53y9GccLPx754gd
// SIG // 6udOo6HBI1PKjfpFzwnQXq/QsEIEovmmbJNn1yjcRlOw
// SIG // htDlKEYuJ6yGT1VSDOQDLPtqkJAwbofzWTCd+n7Wl7Po
// SIG // IZd++NIT8wi3U21StEWQn0gASkdmEScpZqiX5NMGgUqi
// SIG // +YSnEUcUCYKfhO1VeP4Bmh1QCIUAEDBG7bfeI0a7xC1U
// SIG // n68eeEExd8yb3zuDk6FhArUdDbH895uyAc4iS1T/+QXD
// SIG // wiALAgMBAAGjggGrMIIBpzAPBgNVHRMBAf8EBTADAQH/
// SIG // MB0GA1UdDgQWBBQjNPjZUkZwCu1A+3b7syuwwzWzDzAL
// SIG // BgNVHQ8EBAMCAYYwEAYJKwYBBAGCNxUBBAMCAQAwgZgG
// SIG // A1UdIwSBkDCBjYAUDqyCYEBWJ5flJRP8KuEKU5VZ5KSh
// SIG // Y6RhMF8xEzARBgoJkiaJk/IsZAEZFgNjb20xGTAXBgoJ
// SIG // kiaJk/IsZAEZFgltaWNyb3NvZnQxLTArBgNVBAMTJE1p
// SIG // Y3Jvc29mdCBSb290IENlcnRpZmljYXRlIEF1dGhvcml0
// SIG // eYIQea0WoUqgpa1Mc1j0BxMuZTBQBgNVHR8ESTBHMEWg
// SIG // Q6BBhj9odHRwOi8vY3JsLm1pY3Jvc29mdC5jb20vcGtp
// SIG // L2NybC9wcm9kdWN0cy9taWNyb3NvZnRyb290Y2VydC5j
// SIG // cmwwVAYIKwYBBQUHAQEESDBGMEQGCCsGAQUFBzAChjho
// SIG // dHRwOi8vd3d3Lm1pY3Jvc29mdC5jb20vcGtpL2NlcnRz
// SIG // L01pY3Jvc29mdFJvb3RDZXJ0LmNydDATBgNVHSUEDDAK
// SIG // BggrBgEFBQcDCDANBgkqhkiG9w0BAQUFAAOCAgEAEJeK
// SIG // w1wDRDbd6bStd9vOeVFNAbEudHFbbQwTq86+e4+4LtQS
// SIG // ooxtYrhXAstOIBNQmd16QOJXu69YmhzhHQGGrLt48ovQ
// SIG // 7DsB7uK+jwoFyI1I4vBTFd1Pq5Lk541q1YDB5pTyBi+F
// SIG // A+mRKiQicPv2/OR4mS4N9wficLwYTp2OawpylbihOZxn
// SIG // LcVRDupiXD8WmIsgP+IHGjL5zDFKdjE9K3ILyOpwPf+F
// SIG // ChPfwgphjvDXuBfrTot/xTUrXqO/67x9C0J71FNyIe4w
// SIG // yrt4ZVxbARcKFA7S2hSY9Ty5ZlizLS/n+YWGzFFW6J1w
// SIG // lGysOUzU9nm/qhh6YinvopspNAZ3GmLJPR5tH4LwC8cs
// SIG // u89Ds+X57H2146SodDW4TsVxIxImdgs8UoxxWkZDFLyz
// SIG // s7BNZ8ifQv+AeSGAnhUwZuhCEl4ayJ4iIdBD6Svpu/RI
// SIG // zCzU2DKATCYqSCRfWupW76bemZ3KOm+9gSd0BhHudiG/
// SIG // m4LBJ1S2sWo9iaF2YbRuoROmv6pH8BJv/YoybLL+31HI
// SIG // jCPJZr2dHYcSZAI9La9Zj7jkIeW1sMpjtHhUBdRBLlCs
// SIG // lLCleKuzoJZ1GtmShxN1Ii8yqAhuoFuMJb+g74TKIdbr
// SIG // Hk/Jmu5J4PcBZW+JC33Iacjmbuqnl84xKf8OxVtc2E0b
// SIG // odj6L54/LlUWa8kTo/0wggYQMIID+KADAgECAhMzAAAA
// SIG // ZEeElIbbQRk4AAAAAABkMA0GCSqGSIb3DQEBCwUAMH4x
// SIG // CzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpXYXNoaW5ndG9u
// SIG // MRAwDgYDVQQHEwdSZWRtb25kMR4wHAYDVQQKExVNaWNy
// SIG // b3NvZnQgQ29ycG9yYXRpb24xKDAmBgNVBAMTH01pY3Jv
// SIG // c29mdCBDb2RlIFNpZ25pbmcgUENBIDIwMTEwHhcNMTUx
// SIG // MDI4MjAzMTQ2WhcNMTcwMTI4MjAzMTQ2WjCBgzELMAkG
// SIG // A1UEBhMCVVMxEzARBgNVBAgTCldhc2hpbmd0b24xEDAO
// SIG // BgNVBAcTB1JlZG1vbmQxHjAcBgNVBAoTFU1pY3Jvc29m
// SIG // dCBDb3Jwb3JhdGlvbjENMAsGA1UECxMETU9QUjEeMBwG
// SIG // A1UEAxMVTWljcm9zb2Z0IENvcnBvcmF0aW9uMIIBIjAN
// SIG // BgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAky7a2OY+
// SIG // mNkbD2RfTahYTRQ793qE/DwRMTrvicJKLUGlSF3dEp7v
// SIG // q2YoNNV9KlV7TE2K8sDxstNSFYu2swi4i1AL3X/7agmg
// SIG // 3GcExPHfvHUYIEC+eCyZVt3u9S7dPkL5Wh8wrgEUirCC
// SIG // tVGg4m1l/vcYCo0wbU06p8XzNi3uXyygkgCxHEziy/f/
// SIG // JCV/14/A3ZduzrIXtsccRKckyn6B5uYxuRbZXT7RaO6+
// SIG // zUjQhiyu3A4hwcCKw+4bk1kT9sY7gHIYiFP7q78wPqB3
// SIG // vVKIv3rY6LCTraEbjNR+phBQEL7hyBxk+ocu+8RHZhbA
// SIG // hHs2r1+6hURsAg8t4LAOG6I+JQIDAQABo4IBfzCCAXsw
// SIG // HwYDVR0lBBgwFgYIKwYBBQUHAwMGCisGAQQBgjdMCAEw
// SIG // HQYDVR0OBBYEFFhWcQTwvbsz9YNozOeARvdXr9IiMFEG
// SIG // A1UdEQRKMEikRjBEMQ0wCwYDVQQLEwRNT1BSMTMwMQYD
// SIG // VQQFEyozMTY0Mis0OWU4YzNmMy0yMzU5LTQ3ZjYtYTNi
// SIG // ZS02YzhjNDc1MWM0YjYwHwYDVR0jBBgwFoAUSG5k5VAF
// SIG // 04KqFzc3IrVtqMp1ApUwVAYDVR0fBE0wSzBJoEegRYZD
// SIG // aHR0cDovL3d3dy5taWNyb3NvZnQuY29tL3BraW9wcy9j
// SIG // cmwvTWljQ29kU2lnUENBMjAxMV8yMDExLTA3LTA4LmNy
// SIG // bDBhBggrBgEFBQcBAQRVMFMwUQYIKwYBBQUHMAKGRWh0
// SIG // dHA6Ly93d3cubWljcm9zb2Z0LmNvbS9wa2lvcHMvY2Vy
// SIG // dHMvTWljQ29kU2lnUENBMjAxMV8yMDExLTA3LTA4LmNy
// SIG // dDAMBgNVHRMBAf8EAjAAMA0GCSqGSIb3DQEBCwUAA4IC
// SIG // AQCI4gxkQx3dXK6MO4UktZ1A1r1mrFtXNdn06DrARZkQ
// SIG // Tdu0kOTLdlGBCfCzk0309RLkvUgnFKpvLddrg9TGp3n8
// SIG // 0yUbRsp2AogyrlBU+gP5ggHFi7NjGEpj5bH+FDsMw9Py
// SIG // gLg8JelgsvBVudw1SgUt625nY7w1vrwk+cDd58TvAyJQ
// SIG // FAW1zJ+0ySgB9lu2vwg0NKetOyL7dxe3KoRLaztUcqXo
// SIG // YW5CkI+Mv3m8HOeqlhyfFTYxPB5YXyQJPKQJYh8zC9b9
// SIG // 0JXLT7raM7mQ94ygDuFmlaiZ+QSUR3XVupdEngrmZgUB
// SIG // 5jX13M+Pl2Vv7PPFU3xlo3Uhj1wtupNC81epoxGhJ0tR
// SIG // uLdEajD/dCZ0xIniesRXCKSC4HCL3BMnSwVXtIoj/QFy
// SIG // mFYwD5+sAZuvRSgkKyD1rDA7MPcEI2i/Bh5OMAo9App4
// SIG // sR0Gp049oSkXNhvRi/au7QG6NJBTSBbNBGJG8Qp+5QTh
// SIG // KoQUk8mj0ugr4yWRsA9JTbmqVw7u9suB5OKYBMUN4hL/
// SIG // yI+aFVsE/KJInvnxSzXJ1YHka45ADYMKAMl+fLdIqm3n
// SIG // x6rIN0RkoDAbvTAAXGehUCsIod049A1T3IJyUJXt3OsT
// SIG // d3WabhIBXICYfxMg10naaWcyUePgW3+VwP0XLKu4O1+8
// SIG // ZeGyaDSi33GnzmmyYacX3BTqMDCCB3owggVioAMCAQIC
// SIG // CmEOkNIAAAAAAAMwDQYJKoZIhvcNAQELBQAwgYgxCzAJ
// SIG // BgNVBAYTAlVTMRMwEQYDVQQIEwpXYXNoaW5ndG9uMRAw
// SIG // DgYDVQQHEwdSZWRtb25kMR4wHAYDVQQKExVNaWNyb3Nv
// SIG // ZnQgQ29ycG9yYXRpb24xMjAwBgNVBAMTKU1pY3Jvc29m
// SIG // dCBSb290IENlcnRpZmljYXRlIEF1dGhvcml0eSAyMDEx
// SIG // MB4XDTExMDcwODIwNTkwOVoXDTI2MDcwODIxMDkwOVow
// SIG // fjELMAkGA1UEBhMCVVMxEzARBgNVBAgTCldhc2hpbmd0
// SIG // b24xEDAOBgNVBAcTB1JlZG1vbmQxHjAcBgNVBAoTFU1p
// SIG // Y3Jvc29mdCBDb3Jwb3JhdGlvbjEoMCYGA1UEAxMfTWlj
// SIG // cm9zb2Z0IENvZGUgU2lnbmluZyBQQ0EgMjAxMTCCAiIw
// SIG // DQYJKoZIhvcNAQEBBQADggIPADCCAgoCggIBAKvw+nIQ
// SIG // HC6t2G6qghBNNLrytlghn0IbKmvpWlCquAY4GgRJun/D
// SIG // DB7dN2vGEtgL8DjCmQawyDnVARQxQtOJDXlkh36UYCRs
// SIG // r55JnOloXtLfm1OyCizDr9mpK656Ca/XllnKYBoF6WZ2
// SIG // 6DJSJhIv56sIUM+zRLdd2MQuA3WraPPLbfM6XKEW9Ea6
// SIG // 4DhkrG5kNXimoGMPLdNAk/jj3gcN1Vx5pUkp5w2+oBN3
// SIG // vpQ97/vjK1oQH01WKKJ6cuASOrdJXtjt7UORg9l7snuG
// SIG // G9k+sYxd6IlPhBryoS9Z5JA7La4zWMW3Pv4y07MDPbGy
// SIG // r5I4ftKdgCz1TlaRITUlwzluZH9TupwPrRkjhMv0ugOG
// SIG // jfdf8NBSv4yUh7zAIXQlXxgotswnKDglmDlKNs98sZKu
// SIG // HCOnqWbsYR9q4ShJnV+I4iVd0yFLPlLEtVc/JAPw0Xpb
// SIG // L9Uj43BdD1FGd7P4AOG8rAKCX9vAFbO9G9RVS+c5oQ/p
// SIG // I0m8GLhEfEXkwcNyeuBy5yTfv0aZxe/CHFfbg43sTUkw
// SIG // p6uO3+xbn6/83bBm4sGXgXvt1u1L50kppxMopqd9Z4Dm
// SIG // imJ4X7IvhNdXnFy/dygo8e1twyiPLI9AN0/B4YVEicQJ
// SIG // TMXUpUMvdJX3bvh4IFgsE11glZo+TzOE2rCIF96eTvSW
// SIG // sLxGoGyY0uDWiIwLAgMBAAGjggHtMIIB6TAQBgkrBgEE
// SIG // AYI3FQEEAwIBADAdBgNVHQ4EFgQUSG5k5VAF04KqFzc3
// SIG // IrVtqMp1ApUwGQYJKwYBBAGCNxQCBAweCgBTAHUAYgBD
// SIG // AEEwCwYDVR0PBAQDAgGGMA8GA1UdEwEB/wQFMAMBAf8w
// SIG // HwYDVR0jBBgwFoAUci06AjGQQ7kUBU7h6qfHMdEjiTQw
// SIG // WgYDVR0fBFMwUTBPoE2gS4ZJaHR0cDovL2NybC5taWNy
// SIG // b3NvZnQuY29tL3BraS9jcmwvcHJvZHVjdHMvTWljUm9v
// SIG // Q2VyQXV0MjAxMV8yMDExXzAzXzIyLmNybDBeBggrBgEF
// SIG // BQcBAQRSMFAwTgYIKwYBBQUHMAKGQmh0dHA6Ly93d3cu
// SIG // bWljcm9zb2Z0LmNvbS9wa2kvY2VydHMvTWljUm9vQ2Vy
// SIG // QXV0MjAxMV8yMDExXzAzXzIyLmNydDCBnwYDVR0gBIGX
// SIG // MIGUMIGRBgkrBgEEAYI3LgMwgYMwPwYIKwYBBQUHAgEW
// SIG // M2h0dHA6Ly93d3cubWljcm9zb2Z0LmNvbS9wa2lvcHMv
// SIG // ZG9jcy9wcmltYXJ5Y3BzLmh0bTBABggrBgEFBQcCAjA0
// SIG // HjIgHQBMAGUAZwBhAGwAXwBwAG8AbABpAGMAeQBfAHMA
// SIG // dABhAHQAZQBtAGUAbgB0AC4gHTANBgkqhkiG9w0BAQsF
// SIG // AAOCAgEAZ/KGpZjgVHkaLtPYdGcimwuWEeFjkplCln3S
// SIG // eQyQwWVfLiw++MNy0W2D/r4/6ArKO79HqaPzadtjvyI1
// SIG // pZddZYSQfYtGUFXYDJJ80hpLHPM8QotS0LD9a+M+By4p
// SIG // m+Y9G6XUtR13lDni6WTJRD14eiPzE32mkHSDjfTLJgJG
// SIG // KsKKELukqQUMm+1o+mgulaAqPyprWEljHwlpblqYluSD
// SIG // 9MCP80Yr3vw70L01724lruWvJ+3Q3fMOr5kol5hNDj0L
// SIG // 8giJ1h/DMhji8MUtzluetEk5CsYKwsatruWy2dsViFFF
// SIG // WDgycScaf7H0J/jeLDogaZiyWYlobm+nt3TDQAUGpgEq
// SIG // KD6CPxNNZgvAs0314Y9/HG8VfUWnduVAKmWjw11SYobD
// SIG // HWM2l4bf2vP48hahmifhzaWX0O5dY0HjWwechz4GdwbR
// SIG // BrF1HxS+YWG18NzGGwS+30HHDiju3mUv7Jf2oVyW2ADW
// SIG // oUa9WfOXpQlLSBCZgB/QACnFsZulP0V3HjXG0qKin3p6
// SIG // IvpIlR+r+0cjgPWe+L9rt0uX4ut1eBrs6jeZeRhL/9az
// SIG // I2h15q/6/IvrC4DqaTuv/DDtBEyO3991bWORPdGdVk5P
// SIG // v4BXIqF4ETIheu9BCrE/+6jMpF3BoYibV3FWTkhFwELJ
// SIG // m3ZbCoBIa/15n8G9bW1qyVJzEw16UM0xggSqMIIEpgIB
// SIG // ATCBlTB+MQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2Fz
// SIG // aGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZDEeMBwGA1UE
// SIG // ChMVTWljcm9zb2Z0IENvcnBvcmF0aW9uMSgwJgYDVQQD
// SIG // Ex9NaWNyb3NvZnQgQ29kZSBTaWduaW5nIFBDQSAyMDEx
// SIG // AhMzAAAAZEeElIbbQRk4AAAAAABkMAkGBSsOAwIaBQCg
// SIG // gb4wGQYJKoZIhvcNAQkDMQwGCisGAQQBgjcCAQQwHAYK
// SIG // KwYBBAGCNwIBCzEOMAwGCisGAQQBgjcCARUwIwYJKoZI
// SIG // hvcNAQkEMRYEFEfLXL9wuWvHMaMQft24kEqrOL3tMF4G
// SIG // CisGAQQBgjcCAQwxUDBOoAyACgBBAGQAUwBEAEuhPoA8
// SIG // aHR0cDovL2Vkd2ViL3NpdGVzL0lTU0VuZ2luZWVyaW5n
// SIG // L0VuZ0Z1bi9TaXRlUGFnZXMvSG9tZS5hc3B4MA0GCSqG
// SIG // SIb3DQEBAQUABIIBABUWY4uma0xsZDhYqzY3xqPXgcH4
// SIG // oAs2wjjT6xTIGk1MZk8DXIxy0W5AjfzGPIuv0Yd0ziDR
// SIG // vZi+sv8LznSCHQHV69F2PRCwwWlphQ1bixmYrv1gcBlM
// SIG // 8JvPSAOAnIRab9o9jSCiE7vgFUB5MT5Y35y3DQ4cfdsc
// SIG // WSjo7qNkprnVhSYkpaMFUaU27oNQqbiCpgFoCGeOVI8K
// SIG // dfcBTmy88vohVrOlkzBFMoEkCI4SIyXHwISM/GUbU2Y3
// SIG // tTXmoaCiDyvU2Io3md5i0WPY30PP12HyIqKNNlJ+Az7u
// SIG // rQl0ZFkum6h9aJdD7TgGfu5HQpkmcRLLoZSLL0ugFG9c
// SIG // LJ0YtXChggIoMIICJAYJKoZIhvcNAQkGMYICFTCCAhEC
// SIG // AQEwgY4wdzELMAkGA1UEBhMCVVMxEzARBgNVBAgTCldh
// SIG // c2hpbmd0b24xEDAOBgNVBAcTB1JlZG1vbmQxHjAcBgNV
// SIG // BAoTFU1pY3Jvc29mdCBDb3Jwb3JhdGlvbjEhMB8GA1UE
// SIG // AxMYTWljcm9zb2Z0IFRpbWUtU3RhbXAgUENBAhMzAAAA
// SIG // mpqbFsKD2tXCAAAAAACaMAkGBSsOAwIaBQCgXTAYBgkq
// SIG // hkiG9w0BCQMxCwYJKoZIhvcNAQcBMBwGCSqGSIb3DQEJ
// SIG // BTEPFw0xNjA3MjkxNzU4MzRaMCMGCSqGSIb3DQEJBDEW
// SIG // BBTI+GgOu5x4kzraP72rOwl6yaJfsDANBgkqhkiG9w0B
// SIG // AQUFAASCAQCTi2n84uCynxzAatdCZsUEIW5oGbmGNB0l
// SIG // 9JyJpHHjqw9VxuDIE7wVN7/6R5Mq1vl/AjqUgRS5DRlD
// SIG // xtsMCA/SATP/+VpHwK28mwPeNc0V1KVsi8w0ezVU/gtQ
// SIG // HHM2NGGJY+YYDHoyM0gKUUk7+Rebvcj2s/m2thlkNXy+
// SIG // +VSPTYdIW6peT5a/lmgk8wlvL6Bfe3KM3YGQ7G8/N69u
// SIG // VmI67lsClIriwzu5qzoseFX/GqQuJaK2LwHr8v1rMmat
// SIG // BOVgsOwxe/HdI5rkPzUvPIimrPLd6yJjPBtnp4aGoYwZ
// SIG // VenBHjoGAU8HTygNmMtkJs8UyLal4BSgOLwtLf0XUFV8
// SIG // End signature block
